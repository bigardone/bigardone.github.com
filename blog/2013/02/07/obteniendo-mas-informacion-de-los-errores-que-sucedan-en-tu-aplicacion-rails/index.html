<!DOCTYPE html> <!--[if lt IE 7]><html class="no-js lt-ie10 lt-ie9 lt-ie8 lt-ie7" lang=en-us><![endif]--> <!--[if IE 7]><html class="no-js lt-ie10 lt-ie9 lt-ie8" lang=en-us><![endif]--> <!--[if IE 8]><html class="no-js lt-ie10 lt-ie9" lang=en-us><![endif]--> <!--[if IE 9]><html class="no-js lt-ie10 lt-ie9" lang=en-us><![endif]--> <!--[if lt IE 10]><html class="no-js lt-ie10" lang=en-us><![endif]--> <!--[if !IE]>><![endif]--> <html class=no-js lang=en> <head> <title>Obteniendo más información de los errores que suceden en tu aplicación Rails - Code, Love & Boards</title> <meta charset=utf-8 content='text/html' http-equiv=content-type> <meta content='ie=edge,chrome=1' http-equiv=x-ua-compatible> <meta content='A blog about coding web apps, loving life and board sports by Ricardo García Vega' name=description> <meta content='Ricardo García Vega - http://twitter.com/bigardone' name=author> <meta content='code, rails, errors' name=keywords> <meta content='initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width' name=viewport> <link href='//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css' rel=stylesheet> <link href="//fonts.googleapis.com/css?family=Montserrat:400,700|Lora:400,700" media=screen rel=stylesheet /> <link href="../../../../../stylesheets/blog-82c14d7c.css" media=all rel=stylesheet /> <link href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/tomorrow.min.css' rel=stylesheet> <script src='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js'></script> <script src='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/elixir.min.js'></script> <script src='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/elm.min.js'></script> <link href='/images/apple-touch-icon-57x57-6e598dc4.png' rel=apple-touch-icon sizes=57x57> <link href='/images/apple-touch-icon-114x114-5be964ba.png' rel=apple-touch-icon sizes=114x114> <link href='/images/apple-touch-icon-72x72-70084a85.png' rel=apple-touch-icon sizes=72x72> <link href='/images/apple-touch-icon-144x144-1dbb56c1.png' rel=apple-touch-icon sizes=144x144> <link href='/images/apple-touch-icon-60x60-d05a5ea9.png' rel=apple-touch-icon sizes=60x60> <link href='/images/apple-touch-icon-120x120-5dafce59.png' rel=apple-touch-icon sizes=120x120> <link href='/images/apple-touch-icon-76x76-b2c0d784.png' rel=apple-touch-icon sizes=76x76> <link href='/images/apple-touch-icon-152x152-45595360.png' rel=apple-touch-icon sizes=152x152> <link href='/images/favicon-160x160-944ce76e.png' rel=icon sizes=160x160 type='image/png'> <link href='/images/favicon-96x96-b7e4e089.png' rel=icon sizes=96x96 type='image/png'> <link href='/images/favicon-32x32-b7f34a79.png' rel=icon sizes=32x32 type='image/png'> <link href='/images/favicon-16x16-2712c528.png' rel=icon sizes=16x16 type='image/png'> <meta content='#9f00a7' name=msapplication-TileColor> <meta content='/images/mstile-144x144-028d4c4c.png' name=msapplication-TileImage> <script>
  var _StatHat = _StatHat || [];
  _StatHat.push(['_setUser', 'NzIzMCDaNaL5bvEP1HQkMYwfYsQe']);
  (function() {
          var sh = document.createElement('script'); sh.type = 'text/javascript';
          sh.async = true;
          sh.src = '//www.stathat.com/javascripts/api.js';
          var s = document.getElementsByTagName('script')[0];
          s.parentNode.insertBefore(sh, s);
  })();
</script> <link href='//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css' rel=stylesheet> <script src='//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js'></script> <script>
  window.addEventListener("load", function(){
  window.cookieconsent.initialise({
    "palette": {
      "popup": {
        "background": "#252e39"
      },
      "button": {
        "background": "#217dbb"
      }
    },
    "theme": "classic",
    "position": "bottom-right"
  })});
</script> </head> <body class=blog> <header id=main_header> <div class=main-logo> <a href="/"><img src="../../../../../images/logo-cd52bd68.png"/> </a> </div> <div class=container> <section class=center> <h1>Obteniendo más información de los errores que suceden en tu aplicación Rails</h1> <h3></h3> <div class=meta-data> <hr> posted Feb 7, 2013 on <a class=tag href="/blog/tags/code.html">code</a> <a class=tag href="/blog/tags/rails.html">rails</a> <a class=tag href="/blog/tags/errors.html">errors</a> </div> </section> </div> </header> <section id=main_content> <div class=container> <section> <article> <p>Por muchas pruebas que hagamos y creamos tener todo controlado, los errores ocurren. Por eso es importante poder conseguir la mayor información sobre ellos en cuanto aparezcan, para poder corregirlos lo antes posible. Así mismo, en producción es importante si algo que no esperamos ocurre, al usuario se le notifique de manera amigable, en vez de mostrar una página de error que provoque en él el reflejo de apagar directamente su ordenador por si &quot;ha roto algo&quot;. Por estos motivos quiero compartir con vosotros tres formas muy sencillas de hacer nuestras páginas de errores y la información que recibimos sobre ellos más amigable y entendible.</p> <h3>Mejores páginas de error en el entorno de desarrollo con better_errors</h3> <p>Aunque mientras desarrollamos, la página de error por defecto de Rails puede sernos de ayuda para entender que ha ido mal, con la gema <a href="https://github.com/charliesome/better_errors" target=_blank title="Better Errors">better_errors</a> la cosa cambia completamente. Esta joya (más que gema) reemplaza esa página de error sosa por una suya propia tuning, con el siguiente aspecto:</p> <p><img src="https://a248.e.akamai.net/camo.github.com/f05d967fb90cbe3e686ad794062c2151f7ee19a5/687474703a2f2f692e696d6775722e636f6d2f7a594f58462e706e67"/></p> <p>Ya no solo supera gráficamente a la original, sino que además nos aporta las siguientes mejoras a nivel funcional:</p> <ul> <li><strong>La traza de la pila completa</strong>, donde si pinchas en la clase por donde ha ido sucediendo el error, se actualizará en panel de la derecha de la pantalla con el código de esa clase para que puedas inspeccionarlo.</li> <li><strong>Inspección de variables locales y de instancia</strong>, donde podremos ver sus valores en todo momento.</li> <li>Y lo que más me ha flipado, <strong>REPL en vivo</strong>, es decir, nos proporciona una consola de Rails donde probar nuestro código y hacer lo que queramos como si se tratase del mismísimo FireBug o la consola de JavaScript de Chrome.</li> </ul> <p>No se para vosotros, pero para mi es una de las gemas más chulas y útiles que he visto últimamente, así que no dudéis en instalarla en vuestro aplicación. Para ello solo tenéis que añadir lo siguiente a vuestro <strong>Gemfile</strong></p> <pre><code class="ruby">group :development do
  gem &quot;better_errors&quot;
  gem &quot;binding_of_caller
end
</code></pre> <h3>Recibiendo notificaciones de los errores en producción con Airbrake</h3> <p><a href="https://airbrake.io/pages/home" target=_blank title=Airbrake>Airbrake</a> es una aplicación web que se encarga de recolectar toda la información de los errores en vuestras aplicaciones para luego informaros de ellos. Para usarla, solo tenéis que daros de alta (existe un <a href="https://signup.airbrake.io/account/new/Free" target=_blank title="Airbrake free plan">plan gratuito</a> si lo queréis usar mientras estáis desarrollando) y copiar la clave de Api que os crea. A continuación añadís su gema en vuestro Gemfile:</p> <pre><code class="ruby">gem &quot;airbrake&quot;
</code></pre> <p>Y ejecutais lo siguiente desde vuestra consola:</p> <pre><code>$ bundle install
$ rails generate airbrake --api-key vuestra_clave_api
</code></pre> <p>La próxima vez que despleguéis, Airbrake se encargará de ir recibiendo los errores que ocurran e ir avisándoos por email de ellos. Si entráis en vuestro panel de control de la propia aplicación podréis ver vuestros proyectos con sus respectivos errores, sus trazas completas, las veces que han sucedido, incluso podéis vincularlo con vuestro repositorio <strong>GitHub</strong></p> <p><img src="/images/blog/airbrakescreen-7d35a3e7.png"/></p> <p>Recientemente desplegando en <strong>Heroku</strong> un determinado controlador siempre me devolvía un error 500, y los logs de Heroku no me daban más información sobre qué estaba pasando. Al entrar en mi Airbrake, puede ver que simplemente se trataba de que no había pre compilado una hoja de estilos de un plugin que había añadido en la carpeta vendors de mi proyecto. Así de fácil :)</p> <h3>Páginas personalizadas de error para los usuarios en el entorno de producción</h3> <p>Las páginas de error por defecto de una aplicación Rails son muy simples, y poco integradas con la aplicación en si en cuanto a información que aparece e incluso estilos. En entornos de producción como <a href="//www.heroku.com/" target=_blank title=Heroku>Heroku</a> estas se pueden personalizar colgándolas en otros sitio y configurando el entorno para que las muestre cuando un error suceda. Pero hay una manera más sencilla de mostrar páginas de error personalizadas y completamente integradas con vuestra aplicación. En vuestro <code>application_controller.rb</code> añadid lo siguiente:</p> <pre><code class="ruby">class ApplicationController &lt; ActionController::Base

  unless Rails.application.config.consider_all_requests_local
    rescue_from Exception, with: :render_500
    rescue_from ActionController::RoutingError, with: :render_404
    rescue_from ActionController::UnknownController, with: :render_404
    rescue_from AbstractController::ActionNotFound, with: :render_404
    rescue_from ActiveRecord::RecordNotFound, with: :render_404
  end

  def render_404(exception)
    render template: &#39;errors/error_404&#39;, layout: &#39;layouts/application&#39;, status: 404
  end

  def render_500(exception)
    @error = exception
    render template: &#39;errors/error_500&#39;, layout: &#39;layouts/application&#39;, status: 500
  end

end
</code></pre> <p>De esta manera capturará esas excepciones o las que queráis capturar, mostrando las vistas que le indiquéis para cada caso. No os olvidéis de añadir la siguiente linea en vuestra configuración de desarrollo para que ignore esto y os siga mostrando las páginas de errores por defecto o la de <strong>better_errors</strong></p> <pre><code># config/environments/development.rb
config.consider_all_requests_local = true
</code></pre> <p>Espero que estos tres simples métodos os ayuden como me ayudan a mi a comprender y terminar con todos lo errores que van saliendo en mis aplicaciones.</p> <p>Love &amp; Boards!</p> <div id=disqus_thread></div> <script>
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'codeloveandboards'; // required: replace example with your forum shortname
  
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script> <noscript> Please enable JavaScript to view the <a href='//disqus.com/?ref_noscript'>comments powered by Disqus.</a> </noscript> <a class=dsq-brlink href='//disqus.com'> comments powered by <span class=logo-disqus>Disqus</span> </a> </article> </section> </div> </section> <footer id=main_footer> <ul class=article-nav> <li class=previous> <a href="/blog/2013/01/30/probando-tus-emails-desde-tu-entorno-de-desarrollo-en-ruby-on-rails/"><h4>previous post</h4> <h3> Probando tus emails desde tu entorno de desarrollo en Ruby on Rails </h3> <div class=meta-data> <hr> posted Jan 30, 2013 on code, rails, development, mailer </div> </a> </li> <li class=next> <a href="/blog/2013/02/14/dos-maneras-de-tener-siempre-a-mano-toda-la-informacion-de-tu-aplicacion-rails-en-desarrollo/"><h4>next post</h4> <h3> Dos maneras de tener siempre a mano toda la información de tu aplicación mientras la desarrollas </h3> <div class=meta-data> <hr> posted Feb 14, 2013 on code, rails, logs </div> </a> </li> </ul> <section> <div class=container> <div class=center> <ul> <li> <a href='/blog'>Archives</a> </li> <li> <a href='//feeds.feedburner.com/CodeLoveAndBoards' target=_blank>RSS</a> </li> </ul> Copyright © 2018 - Ricardo García Vega - Code, Love & Boards! </div> </div> </section> </footer> <script src="../../../../../javascripts/blog-5ddb0520.js"></script> <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
  ga('create', 'UA-37802122-1', 'codeloveandboards.com');
  ga('send', 'pageview');
</script> <script>
  _StatHat.push(["_trackCount", "g2pcD9xou7DlR0DtndiwvSBBYU5k", 1.0]);
</script> </body> </html>