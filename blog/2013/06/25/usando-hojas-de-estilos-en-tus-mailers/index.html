<!DOCTYPE html> <!--[if lt IE 7]><html class="no-js lt-ie10 lt-ie9 lt-ie8 lt-ie7" lang=en-us><![endif]--> <!--[if IE 7]><html class="no-js lt-ie10 lt-ie9 lt-ie8" lang=en-us><![endif]--> <!--[if IE 8]><html class="no-js lt-ie10 lt-ie9" lang=en-us><![endif]--> <!--[if IE 9]><html class="no-js lt-ie10 lt-ie9" lang=en-us><![endif]--> <!--[if lt IE 10]><html class="no-js lt-ie10" lang=en-us><![endif]--> <!--[if !IE]>><![endif]--> <html class=no-js lang=en> <head> <title>Usando hojas de estilos en tus mailers - Code, Love & Boards</title> <meta charset=utf-8 content='text/html' http-equiv=content-type> <meta content='ie=edge,chrome=1' http-equiv=x-ua-compatible> <meta content='A blog about coding web apps, loving life and board sports by Ricardo García Vega' name=description> <meta content='Ricardo García Vega - http://twitter.com/bigardone' name=author> <meta content='ruby, rails, mailer, gems' name=keywords> <meta content='initial-scale=1.0,user-scalable=no,maximum-scale=1,width=device-width' name=viewport> <link href='//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css' rel=stylesheet> <link href="//fonts.googleapis.com/css?family=Montserrat:400,700|Lora:400,700" media=screen rel=stylesheet /> <link href="../../../../../stylesheets/blog-ed6b1e0f.css" media=all rel=stylesheet /> <link href='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/styles/tomorrow.min.css' rel=stylesheet> <script src='//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.11.0/highlight.min.js'></script> <link href='/images/apple-touch-icon-57x57-6e598dc4.png' rel=apple-touch-icon sizes=57x57> <link href='/images/apple-touch-icon-114x114-5be964ba.png' rel=apple-touch-icon sizes=114x114> <link href='/images/apple-touch-icon-72x72-70084a85.png' rel=apple-touch-icon sizes=72x72> <link href='/images/apple-touch-icon-144x144-1dbb56c1.png' rel=apple-touch-icon sizes=144x144> <link href='/images/apple-touch-icon-60x60-d05a5ea9.png' rel=apple-touch-icon sizes=60x60> <link href='/images/apple-touch-icon-120x120-5dafce59.png' rel=apple-touch-icon sizes=120x120> <link href='/images/apple-touch-icon-76x76-b2c0d784.png' rel=apple-touch-icon sizes=76x76> <link href='/images/apple-touch-icon-152x152-45595360.png' rel=apple-touch-icon sizes=152x152> <link href='/images/favicon-160x160-944ce76e.png' rel=icon sizes=160x160 type='image/png'> <link href='/images/favicon-96x96-b7e4e089.png' rel=icon sizes=96x96 type='image/png'> <link href='/images/favicon-32x32-b7f34a79.png' rel=icon sizes=32x32 type='image/png'> <link href='/images/favicon-16x16-2712c528.png' rel=icon sizes=16x16 type='image/png'> <meta content='#9f00a7' name=msapplication-TileColor> <meta content='/images/mstile-144x144-028d4c4c.png' name=msapplication-TileImage> <script>
  var _StatHat = _StatHat || [];
  _StatHat.push(['_setUser', 'NzIzMCDaNaL5bvEP1HQkMYwfYsQe']);
  (function() {
          var sh = document.createElement('script'); sh.type = 'text/javascript';
          sh.async = true;
          sh.src = '//www.stathat.com/javascripts/api.js';
          var s = document.getElementsByTagName('script')[0];
          s.parentNode.insertBefore(sh, s);
  })();
</script> <link href='//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css' rel=stylesheet> <script src='//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js'></script> <script>
  window.addEventListener("load", function(){
  window.cookieconsent.initialise({
    "palette": {
      "popup": {
        "background": "#252e39"
      },
      "button": {
        "background": "#217dbb"
      }
    },
    "theme": "classic",
    "position": "bottom-right"
  })});
</script> </head> <body class=blog> <header id=main_header> <div class=main-logo> <a href="/"><img src="../../../../../images/logo-cd52bd68.png"/> </a> </div> <div class=container> <section class=center> <h1>Usando hojas de estilos en tus mailers</h1> <h3></h3> <div class=meta-data> <hr> posted Jun 25, 2013 on <a class=tag href="/blog/tags/ruby.html">ruby</a> <a class=tag href="/blog/tags/rails.html">rails</a> <a class=tag href="/blog/tags/mailer.html">mailer</a> <a class=tag href="/blog/tags/gems.html">gems</a> </div> </section> </div> </header> <section id=main_content> <div class=container> <section> <article> <p>En un post anterior vimos cómo <a href="/blog/2013/01/30/probando-tus-emails-desde-tu-entorno-de-desarrollo-en-ruby-on-rails">probar nuestros mailers</a> en nuestro entorno de desarrollo sin necesidad de tener que enviarlos de forma real. También conocimos una gema muy útil llamada <a href="https://github.com/37signals/mail_view" target=_blank title="Mail view">mail_view</a> que nos puede ayudar con el diseño de nuestros emails mostrándonos el resultado final desde nuestro navegador a medida que vamos desarrollando las vistas de los mismos. ¿Pero qué pasa cuando queremos diseñar una plantilla chula para nuestro emails?</p> <p>Debido a la gran variedad de clientes de correo que existen y sus <a href="//www.campaignmonitor.com/css/" target=_blank>múltiples incompatibilidades</a>, una buena práctica que se recomienda llevar a cabo para generar emails con contenido HTML es la de añadir todos los <strong>estilos en linea</strong>. Es decir, cada elemento de nuestro HTML al que queremos dar estilos, debe llevarlos en su propio atributo <code>style</code>. Con que queramos generar una plantilla un poco curiosa, esto va a significar que vamos a tener <strong>repetir muchos estilos</strong>, y lo que es peor aún, si queremos cambiar algo vamos a tener que cambiarlo en muchos sitios, lo que choca un poco con el principio <a href="//es.wikipedia.org/wiki/No_te_repitas" target=_blank title="Don't repear yourself">DRY</a> de <strong>Rails</strong>. Además, habiendo desarrollado ya unas hojas de estilos decentes para nuestra aplicación, que menos que poder reutilizar parte de estos estilos en nuestros emails. ¿Pero cómo podemos hacer esto?</p> <h3>Roadie al rescate</h3> <p><a href="https://github.com/Mange/roadie" target=_blank title=Roadie>Esta gema</a> nos ayuda en esta labor, cogiendo las hojas de estilos que especifiquemos en nuestra plantilla y reescribiendo todo el HTML del email para aplicarle los estilos en linea. Además de esto nos ayuda a sobrescribir todas las URLs de nuestras imágenes para que sean <strong>absolutas</strong>, y así visibles desde cualquiera de nuestro entornos.</p> <p>Para instalarla solo la tenemos que añadir a nuestro <code>Gemfile</code>:</p> <pre><code>gem &#39;roadie&#39;
</code></pre> <p>Una vez ejecutamos el consiguiente <code>bundle install</code>, ya la tendremos lista para funcionar. Para que coja cualquier hoja de estilos y haga su magia, podemos elegir varia formas de hacerlo:</p> <p>La primera sería añadiendo un tag haciendo referencia a la hoja de estilos que queramos usar:</p> <pre><code>&lt;link rel=&quot;stylesheet&quot; href=&quot;nombre_de_tu_hoja_de_estilos.css&quot;/&gt;
</code></pre> <p>También podemos incrustar en nuestra plantilla sus estilos en su correspondiente <code>style</code> tag:</p> <pre><code>&lt;style type=&quot;text/css&quot;&gt;
  ...
&lt;/style&gt;
</code></pre> <p>Usando cualquiera de las anteriores opciones, <strong>Roadie</strong> quitaría esas referencias o estilos, aplicándolos en line sobre el propio HTML. Si no queremos insertar estos tags en nuestro layout, nos permite pasarle el nombre de la hoja de estilos que queremos aplicarle como parámetro <code>:css</code> en nuestros <strong>mailers</strong>:</p> <pre><code class="ruby">
# app/mailers/invoice_mailer.rb
class InvoiceMailer &lt; ActionMailer::Base

  default from: &quot;orders@gvbtool.com&quot;, css: :email

  ...

end
</code></pre> <p>Para que reemplace todas las URLs de nuestras imágenes por rutas absolutas, tenemos que especificar la siguiente configuración en nuestro <code>application.rb</code>, o en cada fichero de configuración de entorno, si variase la ruta entre ellos:</p> <pre><code>config.action_mailer.default_url_options = { host: &#39;localhost&#39;, port: 3000 }
</code></pre> <p>Ahora todos a diseñar emails chulos para vuestros usuarios :)</p> <p>Love &amp; Boards!</p> <div id=disqus_thread></div> <script>
  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
  var disqus_shortname = 'codeloveandboards'; // required: replace example with your forum shortname
  
  /* * * DON'T EDIT BELOW THIS LINE * * */
  (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script> <noscript> Please enable JavaScript to view the <a href='//disqus.com/?ref_noscript'>comments powered by Disqus.</a> </noscript> <a class=dsq-brlink href='//disqus.com'> comments powered by <span class=logo-disqus>Disqus</span> </a> </article> </section> </div> </section> <footer id=main_footer> <ul class=article-nav> <li class=previous> <a href="/blog/2013/06/06/limpiando-y-organizando-tus-vistas-en-rails/"><h4>previous post</h4> <h3> Limpiando y organizando tus vistas en Rails </h3> <div class=meta-data> <hr> posted Jun 6, 2013 on ruby, rails, views </div> </a> </li> <li class=next> <a href="/blog/2013/07/02/la-guia-de-estilo-de-ruby/"><h4>next post</h4> <h3> La Guía de Estilo de Ruby </h3> <div class=meta-data> <hr> posted Jul 2, 2013 on ruby </div> </a> </li> </ul> <section> <div class=container> <div class=center> <ul> <li> <a href='/blog'>Archives</a> </li> <li> <a href='//feeds.feedburner.com/CodeLoveAndBoards' target=_blank>RSS</a> </li> </ul> Copyright © 2018 - Ricardo García Vega - Code, Love & Boards! </div> </div> </section> </footer> <script src="../../../../../javascripts/blog-5ddb0520.js"></script> <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  
  ga('create', 'UA-37802122-1', 'codeloveandboards.com');
  ga('send', 'pageview');
</script> <script>
  _StatHat.push(["_trackCount", "g2pcD9xou7DlR0DtndiwvSBBYU5k", 1.0]);
</script> </body> </html>